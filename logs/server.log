INFO:     Will watch for changes in these directories: ['/Users/stevencohen/Projects/universal_recycling/orders_project/backend']
INFO:     Uvicorn running on http://0.0.0.0:8004 (Press CTRL+C to quit)
INFO:     Started reloader process [20118] using StatReload
INFO:     Started server process [20168]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     127.0.0.1:54926 - "GET /orders/audit_trail HTTP/1.1" 200 OK
INFO:     127.0.0.1:54929 - "GET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:54926 - "GET /static/css/style.css HTTP/1.1" 200 OK
INFO:     127.0.0.1:54927 - "GET /static/js/audit_trail.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:54927 - "GET /static/js/components/expand_line_items.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:54926 - "GET /static/js/components/attachment_modal.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:54929 - "GET /static/js/components/order_note_modal.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:54931 - "GET /static/js/components/pdf_modal.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:54933 - "GET /static/js/components/shared_filters.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:54933 - "GET /lookups/requesters HTTP/1.1" 200 OK
INFO:     127.0.0.1:54933 - "GET /lookups/suppliers HTTP/1.1" 200 OK
INFO:     127.0.0.1:54933 - "GET /orders/api/audit_trail_orders HTTP/1.1" 200 OK
INFO:     127.0.0.1:54933 - "GET /orders/api/order_items/393 HTTP/1.1" 200 OK
INFO:     127.0.0.1:54931 - "GET /orders/api/receipt_logs/393 HTTP/1.1" 200 OK
INFO:     127.0.0.1:54929 - "GET /orders/api/order_details_for_audit/393 HTTP/1.1" 200 OK
INFO:     127.0.0.1:54926 - "GET /orders/api/order_audit_history/393 HTTP/1.1" 200 OK
INFO:     127.0.0.1:54926 - "GET /requisitions/pending_requisitions HTTP/1.1" 200 OK
INFO:     127.0.0.1:54926 - "GET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:54929 - "GET /static/css/style.css HTTP/1.1" 200 OK
INFO:     127.0.0.1:54926 - "GET /static/js/pending_requisitions.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:54926 - "GET /static/js/components/shared_filters.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:54929 - "GET /static/js/components/requisitions_attachment_modal.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:54931 - "GET /static/js/components/order_note_modal.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:54933 - "GET /static/js/components/expand_requisition_items.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:54933 - "GET /lookups/requisitioners HTTP/1.1" 200 OK
INFO:     127.0.0.1:54931 - "GET /favicon.ico HTTP/1.1" 200 OK
INFO:     127.0.0.1:54931 - "GET /api/pending_requisitions HTTP/1.1" 200 OK
INFO:     127.0.0.1:54931 - "GET /orders/pending_orders HTTP/1.1" 200 OK
INFO:     127.0.0.1:54931 - "GET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:54933 - "GET /static/css/style.css HTTP/1.1" 200 OK
INFO:     127.0.0.1:54929 - "GET /static/js/pending_orders.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:54929 - "GET /static/js/components/shared_filters.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:54933 - "GET /static/js/components/expand_line_items.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:54931 - "GET /static/js/components/attachment_modal.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:54926 - "GET /static/js/components/order_note_modal.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:54978 - "GET /static/js/components/pdf_modal.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:54977 - "GET /static/js/components/receive_modal.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:54929 - "GET /static/js/components/edit_draft_modal.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:54929 - "GET /lookups/requesters HTTP/1.1" 200 OK
INFO:     127.0.0.1:54977 - "GET /lookups/suppliers HTTP/1.1" 200 OK
INFO:     127.0.0.1:54977 - "GET /orders/api/pending_orders HTTP/1.1" 200 OK
INFO:     127.0.0.1:54977 - "GET /orders/api/items_for_order/393 HTTP/1.1" 200 OK
INFO:     127.0.0.1:54977 - "POST /orders/receive/393 HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/uvicorn/protocols/http/h11_impl.py", line 403, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 187, in __call__
    raise exc
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/backend/endpoints/order_receiving.py", line 36, in receive_order
    current_user_id = user["id"] # Use the user ID from the dependency
                      ~~~~^^^^^^
TypeError: 'NoneType' object is not subscriptable
INFO:     127.0.0.1:55018 - "GET /orders/pending_orders HTTP/1.1" 200 OK
INFO:     127.0.0.1:55018 - "GET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:55020 - "GET /static/css/style.css HTTP/1.1" 200 OK
INFO:     127.0.0.1:55018 - "GET /static/js/pending_orders.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:55018 - "GET /static/js/components/shared_filters.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:55020 - "GET /static/js/components/expand_line_items.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:55022 - "GET /static/js/components/attachment_modal.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:55024 - "GET /static/js/components/order_note_modal.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:55028 - "GET /static/js/components/pdf_modal.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:55027 - "GET /static/js/components/receive_modal.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:55020 - "GET /static/js/components/edit_draft_modal.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:55020 - "GET /lookups/requesters HTTP/1.1" 200 OK
INFO:     127.0.0.1:55028 - "GET /lookups/suppliers HTTP/1.1" 200 OK
INFO:     127.0.0.1:55028 - "GET /orders/api/pending_orders HTTP/1.1" 200 OK
INFO:     127.0.0.1:55028 - "GET /orders/api/items_for_order/393 HTTP/1.1" 200 OK
INFO:     127.0.0.1:55028 - "POST /orders/receive/393 HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/uvicorn/protocols/http/h11_impl.py", line 403, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 187, in __call__
    raise exc
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/backend/endpoints/order_receiving.py", line 36, in receive_order
    current_user_id = user["id"] # Use the user ID from the dependency
                      ~~~~^^^^^^
TypeError: 'NoneType' object is not subscriptable
WARNING:  StatReload detected changes in 'backend/endpoints/orders.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [20168]
INFO:     Started server process [20334]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Will watch for changes in these directories: ['/Users/stevencohen/Projects/universal_recycling/orders_project/backend']
INFO:     Uvicorn running on http://0.0.0.0:8004 (Press CTRL+C to quit)
INFO:     Started reloader process [20562] using StatReload
INFO:     Started server process [20606]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     127.0.0.1:56455 - "GET /orders/pending_orders HTTP/1.1" 200 OK
INFO:     127.0.0.1:56455 - "GET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:56457 - "GET /static/css/style.css HTTP/1.1" 200 OK
INFO:     127.0.0.1:56459 - "GET /static/js/pending_orders.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:56459 - "GET /static/js/components/edit_draft_modal.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:56455 - "GET /static/js/components/order_note_modal.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:56457 - "GET /static/js/components/attachment_modal.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:56464 - "GET /static/js/components/shared_filters.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:56461 - "GET /static/js/components/receive_modal.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:56465 - "GET /static/js/components/expand_line_items.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:56459 - "GET /static/js/components/pdf_modal.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:56459 - "GET /lookups/requesters HTTP/1.1" 200 OK
INFO:     127.0.0.1:56461 - "GET /lookups/suppliers HTTP/1.1" 200 OK
INFO:     127.0.0.1:56461 - "GET /orders/api/pending_orders HTTP/1.1" 200 OK
INFO:     127.0.0.1:56461 - "GET /orders/api/items_for_order/393 HTTP/1.1" 200 OK
INFO:     127.0.0.1:56461 - "POST /orders/receive/393 HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/uvicorn/protocols/http/h11_impl.py", line 403, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 187, in __call__
    raise exc
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/backend/endpoints/order_receiving.py", line 36, in receive_order
    current_user_id = user["id"] # Use the user ID from the dependency
                      ~~~~^^^^^^
TypeError: 'NoneType' object is not subscriptable
INFO:     127.0.0.1:56504 - "GET /orders/pending_orders HTTP/1.1" 200 OK
INFO:     127.0.0.1:56504 - "GET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:56505 - "GET /static/css/style.css HTTP/1.1" 200 OK
INFO:     127.0.0.1:56504 - "GET /static/js/pending_orders.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:56504 - "GET /static/js/components/shared_filters.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:56505 - "GET /static/js/components/expand_line_items.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:56509 - "GET /static/js/components/order_note_modal.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:56507 - "GET /static/js/components/attachment_modal.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:56512 - "GET /static/js/components/receive_modal.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:56513 - "GET /static/js/components/pdf_modal.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:56505 - "GET /static/js/components/edit_draft_modal.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:56505 - "GET /lookups/requesters HTTP/1.1" 200 OK
INFO:     127.0.0.1:56512 - "GET /lookups/suppliers HTTP/1.1" 200 OK
INFO:     127.0.0.1:56512 - "GET /orders/api/pending_orders HTTP/1.1" 200 OK
INFO:     127.0.0.1:56512 - "GET /orders/api/items_for_order/393 HTTP/1.1" 200 OK
INFO:     127.0.0.1:56512 - "POST /orders/receive/393 HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/uvicorn/protocols/http/h11_impl.py", line 403, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 187, in __call__
    raise exc
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/backend/endpoints/order_receiving.py", line 36, in receive_order
    current_user_id = user["id"] # Use the user ID from the dependency
                      ~~~~^^^^^^
TypeError: 'NoneType' object is not subscriptable
INFO:     127.0.0.1:57135 - "GET /logout HTTP/1.1" 200 OK
INFO:     127.0.0.1:57135 - "GET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:57135 - "GET /favicon.ico HTTP/1.1" 200 OK
INFO:     127.0.0.1:57135 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:57135 - "GET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:57137 - "GET /static/css/style.css HTTP/1.1" 200 OK
INFO:     127.0.0.1:57135 - "GET /static/js/login.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:57135 - "GET /favicon.ico HTTP/1.1" 200 OK
INFO:     127.0.0.1:57135 - "POST /login HTTP/1.1" 200 OK
INFO:     127.0.0.1:57135 - "GET /requisitions/new HTTP/1.1" 200 OK
INFO:     127.0.0.1:57135 - "GET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:57137 - "GET /static/css/style.css HTTP/1.1" 200 OK
INFO:     127.0.0.1:57135 - "GET /static/js/new_requisition_main.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:57135 - "GET /static/js/components/utils.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:57135 - "GET /lookups/requisitioners HTTP/1.1" 200 OK
INFO:     127.0.0.1:57137 - "GET /favicon.ico HTTP/1.1" 200 OK
INFO:     127.0.0.1:57137 - "GET /lookups/settings HTTP/1.1" 200 OK
INFO:     127.0.0.1:57137 - "GET /orders/pending_orders HTTP/1.1" 200 OK
INFO:     127.0.0.1:57135 - "GET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:57137 - "GET /static/css/style.css HTTP/1.1" 200 OK
INFO:     127.0.0.1:57216 - "GET /static/js/pending_orders.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:57135 - "GET /static/js/components/order_note_modal.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:57216 - "GET /static/js/components/expand_line_items.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:57137 - "GET /static/js/components/attachment_modal.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:57220 - "GET /static/js/components/edit_draft_modal.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:57218 - "GET /static/js/components/pdf_modal.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:57222 - "GET /static/js/components/shared_filters.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:57135 - "GET /static/js/components/receive_modal.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:57135 - "GET /lookups/requesters HTTP/1.1" 200 OK
INFO:     127.0.0.1:57222 - "GET /lookups/suppliers HTTP/1.1" 200 OK
INFO:     127.0.0.1:57222 - "GET /orders/api/pending_orders HTTP/1.1" 200 OK
INFO:     127.0.0.1:57222 - "GET /orders/api/items_for_order/393 HTTP/1.1" 200 OK
INFO:     127.0.0.1:57222 - "POST /orders/receive/393 HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/uvicorn/protocols/http/h11_impl.py", line 403, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 187, in __call__
    raise exc
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/middleware/sessions.py", line 85, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/routing.py", line 714, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/routing.py", line 734, in app
    await route.handle(scope, receive, send)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/venv/lib/python3.13/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stevencohen/Projects/universal_recycling/orders_project/backend/endpoints/order_receiving.py", line 36, in receive_order
    current_user_id = user["id"] # Use the user ID from the dependency
                      ~~~~^^^^^^
TypeError: 'NoneType' object is not subscriptable
WARNING:  StatReload detected changes in 'backend/utils/permissions_utils.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [20606]
INFO:     Started server process [20960]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Will watch for changes in these directories: ['/Users/stevencohen/Projects/universal_recycling/orders_project/backend']
INFO:     Uvicorn running on http://0.0.0.0:8004 (Press CTRL+C to quit)
INFO:     Started reloader process [21019] using StatReload
INFO:     Started server process [21078]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     127.0.0.1:57827 - "GET /orders/pending_orders HTTP/1.1" 200 OK
INFO:     127.0.0.1:57827 - "GET /static/css/style.css HTTP/1.1" 200 OK
INFO:     127.0.0.1:57830 - "GET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:57828 - "GET /static/js/pending_orders.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:57828 - "GET /static/js/components/expand_line_items.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:57827 - "GET /static/js/components/attachment_modal.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:57835 - "GET /static/js/components/receive_modal.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:57830 - "GET /static/js/components/shared_filters.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:57836 - "GET /static/js/components/pdf_modal.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:57833 - "GET /static/js/components/order_note_modal.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:57828 - "GET /static/js/components/edit_draft_modal.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:57828 - "GET /lookups/requesters HTTP/1.1" 200 OK
INFO:     127.0.0.1:57833 - "GET /lookups/suppliers HTTP/1.1" 200 OK
INFO:     127.0.0.1:57833 - "GET /orders/api/pending_orders HTTP/1.1" 200 OK
INFO:     127.0.0.1:57833 - "GET /orders/api/items_for_order/393 HTTP/1.1" 200 OK
INFO:     127.0.0.1:57833 - "POST /orders/receive/393 HTTP/1.1" 200 OK
INFO:     127.0.0.1:57833 - "GET /orders/pending_orders HTTP/1.1" 200 OK
INFO:     127.0.0.1:57859 - "GET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:57833 - "GET /static/css/style.css HTTP/1.1" 200 OK
INFO:     127.0.0.1:57861 - "GET /static/js/pending_orders.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:57859 - "GET /static/js/components/attachment_modal.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:57861 - "GET /static/js/components/shared_filters.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:57833 - "GET /static/js/components/expand_line_items.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:57863 - "GET /static/js/components/order_note_modal.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:57866 - "GET /static/js/components/receive_modal.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:57867 - "GET /static/js/components/pdf_modal.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:57859 - "GET /static/js/components/edit_draft_modal.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:57859 - "GET /lookups/requesters HTTP/1.1" 200 OK
INFO:     127.0.0.1:57867 - "GET /lookups/suppliers HTTP/1.1" 200 OK
INFO:     127.0.0.1:57867 - "GET /orders/api/pending_orders HTTP/1.1" 200 OK
INFO:     127.0.0.1:57867 - "GET /orders/audit_trail HTTP/1.1" 200 OK
INFO:     127.0.0.1:57867 - "GET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:57859 - "GET /static/css/style.css HTTP/1.1" 200 OK
INFO:     127.0.0.1:57859 - "GET /static/js/audit_trail.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:57863 - "GET /static/js/components/order_note_modal.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:57866 - "GET /static/js/components/shared_filters.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:57833 - "GET /static/js/components/pdf_modal.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:57859 - "GET /static/js/components/expand_line_items.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:57867 - "GET /static/js/components/attachment_modal.js HTTP/1.1" 200 OK
INFO:     127.0.0.1:57867 - "GET /lookups/requesters HTTP/1.1" 200 OK
INFO:     127.0.0.1:57867 - "GET /lookups/suppliers HTTP/1.1" 200 OK
INFO:     127.0.0.1:57867 - "GET /orders/api/audit_trail_orders HTTP/1.1" 200 OK
INFO:     127.0.0.1:57867 - "GET /orders/api/receipt_logs/393 HTTP/1.1" 200 OK
INFO:     127.0.0.1:57859 - "GET /orders/api/order_audit_history/393 HTTP/1.1" 200 OK
INFO:     127.0.0.1:57866 - "GET /orders/api/order_items/393 HTTP/1.1" 200 OK
INFO:     127.0.0.1:57833 - "GET /orders/api/order_details_for_audit/393 HTTP/1.1" 200 OK
